<div class="container" id="index-page">
  {{!-- filtering --}}
  <form action="/" method="GET" id="filter-form" class="mb-5">
    <div class="input-group mb-3">
      <div class="input-group-prepend">
        <label for=" category-select" class="input-group-text">類別</label>
      </div>
      <select class="form-control" id="category-select" name="category">
        <option value="all" {{#if (eq "all" ../selectedCategory)}}selected{{/if}}>All</option>
        {{#each categories}}
        <option value="{{ this.name }}" {{#if (eq this.name ../selectedCategory)}}selected{{/if}}>{{ this.name }}
        </option>
        {{/each}}
      </select>
    </div>
    <div class="input-group">
      <div class="input-group-prepend">
        <span for="year" class="input-group-text">月份</span>
      </div>
      <select class="form-control" id="year" name="year">
        <option value="all" {{#if (or (eq "all" ../selectedYear) (not ../selectedYear))}}selected{{/if}}>All</option>
        {{#each years}}
        <option value="{{ this }}" {{#if (eq this ../selectedYear)}}selected{{/if}}>{{ this }}
        </option>
        {{/each}}
      </select>
      <label for="year" class="input-group-text" style="border-radius:0px;">年</label>
      <select class="form-control" id="month" name="month">
        <option value="all" {{#if (or (eq "all" ../selectedMonth) (not ../selectedMonth))}}selected{{/if}}>All</option>
        {{#each months}}
        <option value="{{ this }}" {{#if (eq this ../selectedMonth)}}selected{{/if}}>{{ this }}
        </option>
        {{/each}}
      </select>
      <div class="input-group-append">
        <label for="month" class="input-group-text">月</label>
      </div>
    </div>
  </form>

  {{!-- data panel --}}
  <div id="total-amount-wrapper" class="d-flex align-items-start justify-content-between pt-3">
    <span class="total-amount-title">總金額</span>
    <span id="total-amount" class="text-danger">{{ numberFormat totalAmount }}</span>
  </div>
  <ul class="list-group">
    {{#each records}}
    <div class=" d-flex justify-content-between align-items-center">
      <li class="list-group-item">
        <div class="left-item-info row justify-content-between align-items-center">
          <i class="{{ this.category.iconClass }} category col-1" title="{{ this.category.name }}" data-toggle="tooltip"
            data-placement="bottom"></i>
          <div class="middle-info col-7">
            <div class="name">{{ this.name }}</div>
            <div class="date-field" data-timestamp="{{ this.date }}"></div>
          </div>
          <div class="amount col-3 text-right">{{ numberFormat this.amount }}</div>
        </div>

      </li>
      <div class="right-btn-group">
        <a href="/records/edit/{{ this._id }}" class="edit-btn btn btn-sm btn-info"><i class="fas fa-edit"></i></a>
        <form action="/records/{{ this._id }}?_method=DELETE" method="POST" style="display: inline;" class="delete-form"
          data-timestamp="{{ this.date }}" onsubmit="return confirm(`確定要刪除這筆支出嗎?
  名稱: {{ this.name }}
  日期: ${dateFormat('/', new Date(Number(this.dataset.timestamp)))}
  金額: {{ numberFormat this.amount }}`)">
          <button class="delete-btn btn btn-sm btn-secondary"><i class="fas fa-trash-alt"></i></button>
        </form>
      </div>
    </div>
    {{/each}}
  </ul>
</div>